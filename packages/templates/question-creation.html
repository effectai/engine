<div id="app" style="text-align: center">
    <h1>Effect AI - Question Creator</h1>
  
    <hr />
  
    <!-- Wrap the image or canvas element with a block element (container) -->
    <div class="mx-auto" style="max-width: 80%">

      <div class="container is-max-desktop">
        <label class="label has-text-left">Question:</label>
        <textarea
          class="textarea"
          placeholder="Enter your question here"
          type="text" 
          v-model="tmpQuestion"
        >
        </textarea>
      </div>

      <div class="container is-max-desktop box">
        <label class="label">What questions can I add?</label>
        <div class="has-text-left">
          <label class="label">DO:</label>
          <li>Use correct spelling and grammar</li>
          <li>Choose simple questions that are easy for anyone to understand, regardless of culture or context</li>
          <li>Make sure they can be answered in just a couple of sentences</li>
          <br>
          <label class="label">DO NOT:</label>
          <li>Solicit personally identifying information (like names or financial information)</li>
          <li>Express or solicit prejudiced or offensive sentiments</li>
          <li>Ask sensitive questions</li>
        </div>
      </div>
    
    <p class="is-size-7 mb-2">By clicking this button, you accept that the sentence contributed here will be added to a publicly available cc-0 licensed dataset.</p>

    <p style="color: red;"
    :class="{'is-hidden mb-3': !notComplete}">
      Task incomplete - Please complete all sections of the task
    </p>

    <button
      @click.prevent="uploadAndSubmit"
      class="button is-success is-large"
      :class="{'is-loading': btnLoading}"
    >
      Submit
    </button>
  </div>
  
  <!-- ðŸ“š Load in resources: [Bulma, Effect Network Styling]  -->
  <link rel="stylesheet" href="https://unpkg.com/bulma@0.9.4/css/bulma.min.css" />
  <link href="https://app.effect.network/force-defaults.css" rel="stylesheet" />
  
  <script src="https://cdn.jsdelivr.net/npm/ipfs-http-client/dist/index.min.js"></script>
  <script type="module">
    import { createApp } from "https://unpkg.com/vue@3/dist/vue.esm-browser.js";
  
    createApp({
      data() {
        return {
          title: "Effect AI Question Creator",
          tmpQuestion: "",
          btnLoading: false,
          notComplete: false,
        };
      },
      computed: {},
      created() {},
      mounted() {
        window.top.postMessage(
        {
          type: 'task-instructions',
          instructions: this.instructions
        },
        "*"
      );
      },
      methods: {
        async uploadAndSubmit() {
          this.btnLoading = true;
          if(this.tmpQuestion == ""){
            this.notComplete = true
          }
          else
            try {
              parent.postMessage(
                {
                  task: "submit",
                  values: {
                    taskTitle: this.title,
                    answer: this.tmpQuestion,
                  },
                },
                "*"
              );
            } catch (error) {
              console.error("Failed to upload to IPFS", error);
            }
            this.btnLoading = false;
          },
        
      },
    }).mount("#app");
  </script>