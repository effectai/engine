<div id="app" style="text-align: center">
  <h1>Effect AI - Is it AI ?</h1>

  <hr />

  <!-- Wrap the image or canvas element with a block element (container) -->
  <div class="mx-auto" style="max-width: 80%">
    <img
      id="image"
      ref="image"
      :src="imageSource"
      style="max-width: 100%; max-height: 100%; margin: 0 auto; display: block"
    />

    <div class="field">
      <label class="label">Image URL made by AI?</label>
      <label class="radio">
        <input type="radio" name="ai" value="yes" v-model="tmpLabel" />
        Yes
      </label>
      <label class="radio">
        <input type="radio" name="ai" value="no" v-model="tmpLabel" />
        No
      </label>
    </div>

    <button
      @click.prevent="uploadAndSubmit"
      class="button is-primary is-large"
      :class="{'is-loading': btnLoading}"
    >
      Submit
    </button>
  </div>

  <!-- üìö Load in resources: [Bulma, Effect Network Styling]  -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/bulma@0.9.4/css/bulma.min.css"
  />
  <link href="https://app.effect.network/force-defaults.css" rel="stylesheet" />

  <script src="https://cdn.jsdelivr.net/npm/ipfs-http-client/dist/index.min.js"></script>
  <script type="module">
    import { createApp } from "https://unpkg.com/vue@3/dist/vue.esm-browser.js";

    createApp({
      data() {
        return {
          title: "Effect Network Image Labeler üßê",
          imageSource: "${image_url}",
          tmpLabel: "",
          labels: [],
          btnLoading: false,
          ipfsClient: null,
        };
      },
      computed: {},
      created() {},
      mounted() {},
      methods: {
        async uploadAndSubmit() {
          this.btnLoading = true;
          try {
            parent.postMessage(
              {
                task: "submit",
                values: {
                  label: this.tmpLabel,
                  image: this.imageSource,
                },
              },
              "*",
            );
          } catch (error) {
            console.error("Failed to upload to IPFS", error);
          }
          this.btnLoading = false;
        },
      },
    }).mount("#app");
  </script>
</div>
